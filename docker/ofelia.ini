# Ofelia scheduler configuration
# See: https://github.com/mcuadros/ofelia

[global]
# Save job logs to this folder
save-folder = /var/log/ofelia
# Save only failed job logs
save-only-on-error = false

# Daily scrape - runs at 6:00 AM every day
[job-run "daily-scrape"]
schedule = 0 6 * * *
image = alcalorscraper-scraper
network = news_scrapers_network
volume = /home/ieqr/Desktop/alcalorscraper/data:/app/data
environment = DATABASE_URL=postgresql://scraper:${POSTGRES_PASSWORD}@postgres:5432/news_scrapers
command = --today --concurrent 10
no-overlap = true
delete = true

# Catch-up scrape - runs at 8:00 AM to catch yesterday if missed
[job-run "catchup-scrape"]
schedule = 0 8 * * *
image = alcalorscraper-scraper
network = news_scrapers_network
volume = /home/ieqr/Desktop/alcalorscraper/data:/app/data
environment = DATABASE_URL=postgresql://scraper:${POSTGRES_PASSWORD}@postgres:5432/news_scrapers
command = --date $(date -d "yesterday" +%Y-%m-%d) --concurrent 10
no-overlap = true
delete = true

# Weekly health check - runs at 12:00 PM on Sundays
[job-run "health-check"]
schedule = 0 12 * * 0
image = alcalorscraper-scraper
network = news_scrapers_network
environment = DATABASE_URL=postgresql://scraper:${POSTGRES_PASSWORD}@postgres:5432/news_scrapers
command = --health-check
delete = true
